# Design Document

## Overview

Дизайн процесса подготовки FileStash Simple к загрузке на GitHub включает очистку проекта, инициализацию Git репозитория, создание GitHub репозитория и настройку для дальнейшей разработки. Процесс должен сохранить всю функциональность приложения при удалении временных файлов.

## Architecture

### Компоненты системы подготовки:
1. **File Cleanup Module** - Очистка временных файлов и данных
2. **Git Initialization Module** - Настройка локального Git репозитория  
3. **GitHub Integration Module** - Создание и настройка удаленного репозитория
4. **Documentation Update Module** - Обновление документации проекта
5. **Project Validation Module** - Проверка готовности проекта

### Архитектурные принципы:
- Сохранение всех исходных файлов кода
- Удаление только временных и сгенерированных файлов
- Поддержание работоспособности после очистки
- Создание чистого и профессионального репозитория

## Components and Interfaces

### File Cleanup Module
**Назначение:** Очистка проекта от временных файлов
**Входные данные:** Список файлов и папок проекта
**Выходные данные:** Очищенная структура проекта

**Файлы для удаления:**
- `filestash.db` - База данных SQLite (будет создана при первом запуске)
- `backup_*.json` - Резервные копии базы данных
- `archives/` - Папка с архивами (содержимое)
- Логи и временные файлы

**Файлы для сохранения:**
- Все `.js` файлы (server.js, startup.js, тесты)
- Все `.bat` файлы (скрипты запуска)
- `package.json` и `package-lock.json`
- `public/` папка с веб-интерфейсом
- Документация (README.md, отчеты)
- `.gitignore`

### Git Initialization Module
**Назначение:** Инициализация локального Git репозитория
**Входные данные:** Очищенная структура проекта
**Выходные данные:** Инициализированный Git репозиторий

**Операции:**
1. `git init` - Инициализация репозитория
2. `git add .` - Добавление всех файлов
3. `git commit -m "Initial commit: FileStash Simple v1.0"` - Первый коммит
4. Проверка статуса репозитория

### GitHub Integration Module
**Назначение:** Создание GitHub репозитория и загрузка кода
**Входные данные:** Локальный Git репозиторий
**Выходные данные:** Настроенный GitHub репозиторий

**Параметры репозитория:**
- Имя: `filestash-simple`
- Описание: "Simple and fast file manager built with Node.js and SQLite"
- Видимость: Public
- Включить README: Да (использовать существующий)

### Documentation Update Module
**Назначение:** Обновление документации для GitHub
**Входные данные:** Существующие файлы документации
**Выходные данные:** Обновленная документация

**Обновления:**
- Добавление ссылки на GitHub репозиторий в README
- Обновление инструкций по установке
- Добавление информации о лицензии
- Создание CHANGELOG.md для отслеживания изменений

### Project Validation Module
**Назначение:** Проверка готовности проекта к работе
**Входные данные:** Подготовленный проект
**Выходные данные:** Отчет о готовности

**Проверки:**
- Корректность package.json
- Наличие всех необходимых файлов
- Работоспособность npm install
- Запуск тестов
- Проверка .gitignore

## Data Models

### Project Structure Model
```
filestash-simple/
├── .git/                    # Git репозиторий
├── .gitignore              # Исключения Git
├── package.json            # Зависимости Node.js
├── package-lock.json       # Заблокированные версии
├── server.js               # Основной сервер
├── startup.js              # Скрипт запуска
├── *.bat                   # Windows скрипты
├── public/                 # Веб-интерфейс
│   ├── index.html
│   └── app.js
├── test-*.js              # Тестовые файлы
├── README.md              # Документация
├── CHANGELOG.md           # История изменений
└── *.md                   # Отчеты и документация
```

### Git Configuration Model
```json
{
  "repository": {
    "name": "filestash-simple",
    "description": "Simple and fast file manager built with Node.js and SQLite",
    "private": false,
    "has_issues": true,
    "has_projects": true,
    "has_wiki": true
  },
  "branches": {
    "default": "main",
    "protection": false
  }
}
```

## Error Handling

### File Cleanup Errors
- **Ошибка доступа к файлам:** Проверка прав доступа, предупреждение пользователя
- **Файлы в использовании:** Остановка сервера перед очисткой
- **Критические файлы:** Защита от случайного удаления исходного кода

### Git Errors
- **Git не установлен:** Проверка наличия Git, инструкции по установке
- **Конфликты файлов:** Разрешение конфликтов .gitignore
- **Большие файлы:** Предупреждение о файлах > 100MB

### GitHub Errors
- **Аутентификация:** Настройка GitHub CLI или токенов доступа
- **Существующий репозиторий:** Проверка уникальности имени
- **Сетевые ошибки:** Повторные попытки, офлайн режим

### Validation Errors
- **Отсутствующие зависимости:** Автоматическая установка npm install
- **Неработающие тесты:** Отчет о проблемах, продолжение процесса
- **Некорректная структура:** Восстановление из резервной копии

## Testing Strategy

### Unit Tests
- Тестирование модулей очистки файлов
- Проверка Git операций
- Валидация структуры проекта

### Integration Tests
- Полный цикл подготовки к GitHub
- Тестирование после клонирования репозитория
- Проверка работоспособности приложения

### Manual Tests
- Проверка GitHub репозитория в браузере
- Клонирование и запуск на чистой системе
- Тестирование всех функций приложения

### Rollback Strategy
- Создание резервной копии перед началом процесса
- Возможность отката изменений Git
- Восстановление удаленных файлов из резервной копии

## Implementation Considerations

### Prerequisites
- Git установлен и настроен
- GitHub CLI или настроенные SSH ключи
- Node.js и npm для тестирования
- Права на создание репозиториев на GitHub

### Security Considerations
- Исключение конфиденциальных данных из репозитория
- Проверка .gitignore на полноту
- Удаление локальных конфигураций и паролей

### Performance Considerations
- Оптимизация размера репозитория
- Исключение больших бинарных файлов
- Сжатие и оптимизация ресурсов

### Maintenance Considerations
- Настройка автоматических обновлений зависимостей
- Планирование релизов и версионирования
- Документирование процесса разработки